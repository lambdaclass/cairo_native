<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Enum type"><title>cairo_native::types::enum - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-46f98efaafac5295.ttf.woff2,FiraSans-Regular-018c141bf0843ffd.woff2,FiraSans-Medium-8f9a781e4970d388.woff2,SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2,SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../../static.files/rustdoc-081576b923113409.css"><meta name="rustdoc-vars" data-root-path="../../../" data-static-root-path="../../../static.files/" data-current-crate="cairo_native" data-themes="" data-resource-suffix="" data-rustdoc-version="1.79.0 (129f3b996 2024-06-10)" data-channel="1.79.0" data-search-js="search-bf21c90c8c1d92b1.js" data-settings-js="settings-4313503d2e1961c2.js" ><script src="../../../static.files/storage-e32f0c247825364d.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../../static.files/main-20a3ad099b048cf2.js"></script><noscript><link rel="stylesheet" href="../../../static.files/noscript-09095024cf37855e.css"></noscript><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../../cairo_native/index.html">cairo_native</a><span class="version">0.2.0</span></h2></div><h2 class="location"><a href="#">Module enum</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#functions">Functions</a></li><li><a href="#types">Type Aliases</a></li></ul></section><h2><a href="../index.html">In cairo_native::types</a></h2></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><div id="sidebar-button" tabindex="-1"><a href="../../../cairo_native/all.html" title="show sidebar"></a></div><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Type ‘S’ or ‘/’ to search, ‘?’ for more options…" type="search"><div id="help-button" tabindex="-1"><a href="../../../help.html" title="help">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../../settings.html" title="settings">Settings</a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Module <a href="../../index.html">cairo_native</a>::<wbr><a href="../index.html">types</a>::<wbr><a class="mod" href="#">enum</a><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><span class="out-of-band"><a class="src" href="../../../src/cairo_native/types/enum.rs.html#1-583">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><h2 id="enum-type"><a class="doc-anchor" href="#enum-type">§</a>Enum type</h2>
<p>Enumerations are special because they can potentially represent an unlimited amount of things at
the same time. They are similar to Rust enums since they can contain data along with the
discriminator.</p>
<h3 id="layout-1"><a class="doc-anchor" href="#layout-1">§</a>Layout</h3><div><table><thead><tr><th>Index</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td>0</td><td><code>iN</code></td><td>Discriminant.</td></tr>
<tr><td>1</td><td>Depends on variants.</td><td>Payload.</td></tr>
</tbody></table>
</div>
<p>As seen in the table above, an enum’s layout is not as simple as concatenating the discriminant
with the payload.</p>
<p>The discriminant will have the bit width required to store all possible values. The following
table contains an example of some number of variants with their discriminant type:</p>
<div><table><thead><tr><th>Number of variants</th><th>Discriminant type</th><th>ABI (in Rust types)</th></tr></thead><tbody>
<tr><td>0 or 1</td><td><code>i0</code></td><td><code>()</code></td></tr>
<tr><td>2</td><td><code>i1</code></td><td><code>u8</code></td></tr>
<tr><td>3 or 4</td><td><code>i2</code></td><td><code>u8</code></td></tr>
<tr><td>5, 6, 7 or 8</td><td><code>i3</code></td><td><code>u8</code></td></tr>
<tr><td>9 to 16</td><td><code>i4</code></td><td><code>u8</code></td></tr>
<tr><td>129 to 256</td><td><code>i8</code></td><td><code>u8</code></td></tr>
<tr><td>257 to 512</td><td><code>i9</code></td><td><code>u16</code></td></tr>
<tr><td>32769 to 65536</td><td><code>i16</code></td><td><code>u16</code></td></tr>
<tr><td>65537 to 131072</td><td><code>i17</code></td><td><code>u32</code></td></tr>
</tbody></table>
</div>
<p>In Rust, the number of bits and bytes required can be obtained using the following formula:</p>
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
 <semantics>
  <mtable>
   <mtr>
    <mtd>
     <mrow>
      <msub>
       <mi>n</mi>
       <mi mathvariant="italic">bits</mi>
      </msub>
      <mo stretchy="false">=</mo>
      <mrow>
       <mo fence="true" form="prefix" stretchy="true">{</mo>
       <mrow>
        <mtable>
         <mtr>
          <mtd>
           <mn>0</mn>
          </mtd>
          <mtd>
           <mtext>if</mtext>
          </mtd>
          <mtd>
           <mrow>
            <msub>
             <mi>n</mi>
             <mi mathvariant="italic">variants</mi>
            </msub>
            <mo stretchy="false">=</mo>
            <mn>0</mn>
           </mrow>
          </mtd>
         </mtr>
         <mtr>
          <mtd>
           <mrow>
            <mo fence="true" form="prefix" stretchy="true">⌈</mo>
            <mrow>
             <mrow>
              <msub>
               <mi>log</mi>
               <mn>2</mn>
              </msub>
              <msub>
               <mi>n</mi>
               <mi mathvariant="italic">variants</mi>
              </msub>
             </mrow>
            </mrow>
            <mo fence="true" form="postfix" stretchy="true">⌉</mo>
           </mrow>
          </mtd>
          <mtd>
           <mtext>if</mtext>
          </mtd>
          <mtd>
           <mrow>
            <msub>
             <mi>n</mi>
             <mi mathvariant="italic">variants</mi>
            </msub>
            <mo stretchy="false">≠</mo>
            <mn>0</mn>
           </mrow>
          </mtd>
         </mtr>
        </mtable>
       </mrow>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd>
     <mrow>
      <msub>
       <mi>n</mi>
       <mi mathvariant="italic">bytes</mi>
      </msub>
      <mo stretchy="false">=</mo>
      <mrow>
       <mo fence="true" form="prefix" stretchy="true">⌈</mo>
       <mrow>
        <mfrac>
         <msub>
          <mi>n</mi>
          <mi mathvariant="italic">bits</mi>
         </msub>
         <mn>8</mn>
        </mfrac>
       </mrow>
       <mo fence="true" form="postfix" stretchy="true">⌉</mo>
      </mrow>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
 </semantics>
</math>
<p>The payload will then be appended to the discriminant after applying its alignment rules. This
will cause unused space between the tag and the payload in most cases. As an example, the
following enum will have the layouts described in the table below.</p>
<div class="example-wrap"><pre class="language-cairo"><code>enum MyEnum {
    U8: u8,
    U16: u16,
    U32: u32,
    U64: u64,
    Felt: Felt,
}
</code></pre></div><table>
    <thead>
        <tr>
            <th colspan="6"><code>MyEnum::U8</code></th>
        </tr>
        <tr>
            <th>Index</th>
            <th>Type</th>
            <th>ABI (in Rust types)</th>
            <th>Alignment</th>
            <th>Size</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>0</td>
            <td><code>i3</code></td>
            <td><code>u8</code></td>
            <td>1</td>
            <td>1</td>
            <td>Discriminant.</td>
        </tr>
        <tr>
            <td>1</td>
            <td><code>i8</code></td>
            <td><code>u8</code></td>
            <td>1</td>
            <td>1</td>
            <td>Payload.</td>
        </tr>
        <tr>
            <td>N/A</td>
            <td>N/A</td>
            <td><code>[u8; 38]</code></td>
            <td>1</td>
            <td>38</td>
            <td>Padding.</td>
        </tr>
    </tbody>
</table>
<table>
    <thead>
        <tr>
            <th colspan="6"><code>MyEnum::U16</code></th>
        </tr>
        <tr>
            <th>Index</th>
            <th>Type</th>
            <th>ABI (in Rust types)</th>
            <th>Alignment</th>
            <th>Size</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>0</td>
            <td><code>i3</code></td>
            <td><code>u8</code></td>
            <td>1</td>
            <td>1</td>
            <td>Discriminant.</td>
        </tr>
        <tr>
            <td>N/A</td>
            <td>N/A</td>
            <td><code>[u8; 1]</code></td>
            <td>1</td>
            <td>1</td>
            <td>Padding.</td>
        </tr>
        <tr>
            <td>1</td>
            <td><code>i16</code></td>
            <td><code>u16</code></td>
            <td>2</td>
            <td>2</td>
            <td>Payload.</td>
        </tr>
        <tr>
            <td>N/A</td>
            <td>N/A</td>
            <td><code>[u8; 36]</code></td>
            <td>1</td>
            <td>36</td>
            <td>Padding.</td>
        </tr>
    </tbody>
</table>
<table>
    <thead>
        <tr>
            <th colspan="6"><code>MyEnum::U32</code></th>
        </tr>
        <tr>
            <th>Index</th>
            <th>Type</th>
            <th>ABI (in Rust types)</th>
            <th>Alignment</th>
            <th>Size</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>0</td>
            <td><code>i3</code></td>
            <td><code>u8</code></td>
            <td>1</td>
            <td>1</td>
            <td>Discriminant.</td>
        </tr>
        <tr>
            <td>N/A</td>
            <td>N/A</td>
            <td><code>[u8; 3]</code></td>
            <td>1</td>
            <td>3</td>
            <td>Padding.</td>
        </tr>
        <tr>
            <td>1</td>
            <td><code>i32</code></td>
            <td><code>u32</code></td>
            <td>4</td>
            <td>4</td>
            <td>Payload.</td>
        </tr>
        <tr>
            <td>N/A</td>
            <td>N/A</td>
            <td><code>[u8; 32]</code></td>
            <td>1</td>
            <td>32</td>
            <td>Padding.</td>
        </tr>
    </tbody>
</table>
<table>
    <thead>
        <tr>
            <th colspan="6"><code>MyEnum::U64</code></th>
        </tr>
        <tr>
            <th>Index</th>
            <th>Type</th>
            <th>ABI (in Rust types)</th>
            <th>Alignment</th>
            <th>Size</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>0</td>
            <td><code>i3</code></td>
            <td><code>u8</code></td>
            <td>1</td>
            <td>1</td>
            <td>Discriminant.</td>
        </tr>
        <tr>
            <td>N/A</td>
            <td>N/A</td>
            <td><code>[u8; 7]</code></td>
            <td>1</td>
            <td>7</td>
            <td>Padding.</td>
        </tr>
        <tr>
            <td>1</td>
            <td><code>i64</code></td>
            <td><code>u64</code></td>
            <td>8</td>
            <td>8</td>
            <td>Payload.</td>
        </tr>
        <tr>
            <td>N/A</td>
            <td>N/A</td>
            <td><code>[u8; 24]</code></td>
            <td>1</td>
            <td>24</td>
            <td>Padding.</td>
        </tr>
    </tbody>
</table>
<table>
    <thead>
        <tr>
            <th colspan="6"><code>MyEnum</code></th>
        </tr>
        <tr>
            <th>Index</th>
            <th>Type</th>
            <th>ABI (in Rust types)</th>
            <th>Alignment</th>
            <th>Size</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>0</td>
            <td><code>i3</code></td>
            <td><code>u8</code></td>
            <td>1</td>
            <td>1</td>
            <td>Discriminant.</td>
        </tr>
        <tr>
            <td>N/A</td>
            <td>N/A</td>
            <td><code>[u8; 7]</code></td>
            <td>1</td>
            <td>7</td>
            <td>Padding.</td>
        </tr>
        <tr>
            <td>1</td>
            <td><code>i252</code></td>
            <td><code>[u64; 4]</code></td>
            <td>8</td>
            <td>32</td>
            <td>Payload.</td>
        </tr>
    </tbody>
</table>
<p>As seen above, while the discriminant is always at the same offset, the payloads don’t necessary
have the same offset between all variants. It depends on the payload’s alignment.</p>
<p>In reality, the first variant will have a zero-sized padding between the discriminant and the
payload to keep everything consistent and the padding will have its own index, shifting every
index below it by one. However all that’s been ignored for documenting purposes.</p>
<p>An MLIR type cannot be an enumeration (it doesn’t exist), therefore a variant or a buffer has to
be used. Using a buffer as a dummy payload has been discarded because it doesn’t keep the enum’s
alignment information. To keep that info, the first variant with the biggest alignment is used
as the default payload.</p>
<p>Using the info stated above, we can infer that the example enum will have the following type by
default:</p>
<div><table><thead><tr><th>Index</th><th>Type</th><th>ABI (in Rust types)</th><th>Alignment</th><th>Size</th><th>Description</th></tr></thead><tbody>
<tr><td>0</td><td><code>i3</code></td><td><code>u8</code></td><td>1</td><td>1</td><td>Discriminant.</td></tr>
<tr><td>N/A</td><td>N/A</td><td><code>[u8; 7]</code></td><td>1</td><td>7</td><td>Padding.</td></tr>
<tr><td>1</td><td><code>i64</code></td><td><code>u64</code></td><td>8</td><td>8</td><td>Payload.</td></tr>
<tr><td>N/A</td><td>N/A</td><td><code>[u8; 24]</code></td><td>1</td><td>24</td><td>Padding.</td></tr>
</tbody></table>
</div></div></details><h2 id="functions" class="section-header">Functions<a href="#functions" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="fn" href="fn.build.html" title="fn cairo_native::types::enum::build">build</a></div><div class="desc docblock-short">Build the MLIR type.</div></li><li><div class="item-name"><a class="fn" href="fn.get_layout_for_variants.html" title="fn cairo_native::types::enum::get_layout_for_variants">get_layout_for_variants</a></div><div class="desc docblock-short">Extract layout for the default enum representation, its discriminant and all its payloads.</div></li><li><div class="item-name"><a class="fn" href="fn.get_type_for_variants.html" title="fn cairo_native::types::enum::get_type_for_variants">get_type_for_variants</a></div><div class="desc docblock-short">Extract the type and layout for the default enum representation, its discriminant and all its
payloads.</div></li></ul><h2 id="types" class="section-header">Type Aliases<a href="#types" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="type" href="type.TypeLayout.html" title="type cairo_native::types::enum::TypeLayout">TypeLayout</a></div><div class="desc docblock-short">An MLIR type with its memory layout.</div></li></ul></section></div></main></body></html>