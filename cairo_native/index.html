<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Cairo Sierra to MLIR compiler and JIT engine"><title>cairo_native - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-9bb858ba049f1f21.css" id="mainThemeStyle"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="cairo_native" data-themes="" data-resource-suffix="" data-rustdoc-version="1.72.1 (d5c2e9c34 2023-09-13)" data-channel="1.72.1" data-search-js="search-f6292fe389d70017.js" data-settings-js="settings-de11bff964e9d4e5.js" data-settings-css="settings-8c76f75bfb6bd192.css" data-theme-light-css="light-0f8c037637f9eb3e.css" data-theme-dark-css="dark-1097f8e92a01e3cf.css" data-theme-ayu-css="ayu-614652228113ac93.css" ><script src="../static.files/storage-59fd9b8ccb335783.js"></script><script defer src="../crates.js"></script><script defer src="../static.files/main-0795b7d26be81095.js"></script><noscript><link rel="stylesheet" media="(prefers-color-scheme:light)" href="../static.files/light-0f8c037637f9eb3e.css"><link rel="stylesheet" media="(prefers-color-scheme:dark)" href="../static.files/dark-1097f8e92a01e3cf.css"><link rel="stylesheet" href="../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../cairo_native/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../cairo_native/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">Crate cairo_native</a></h2><div class="sidebar-elems"><ul class="block"><li class="version">Version 0.1.0</li><li><a id="all-types" href="all.html">All Items</a></li></ul><section><ul class="block"><li><a href="#modules">Modules</a></li><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#functions">Functions</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Crate <a class="mod" href="#">cairo_native</a><button id="copy-path" title="Copy item path to clipboard"><img src="../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../src/cairo_native/lib.rs.html#1-89">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><h2 id="cairo-sierra-to-mlir-compiler-and-jit-engine"><a href="#cairo-sierra-to-mlir-compiler-and-jit-engine">Cairo Sierra to MLIR compiler and JIT engine</a></h2>
<p>This crate is a compiler and JIT engine that transforms Sierra (or Cairo) sources into MLIR,
which can be <a href="https://en.wikipedia.org/wiki/Just-in-time_compilation">JIT-executed</a> or further
compiled (externally) into a binary
<a href="https://en.wikipedia.org/wiki/Ahead-of-time_compilation">ahead of time</a>.</p>
<h3 id="usage"><a href="#usage">Usage</a></h3>
<p>The API contains two structs, <code>NativeContext</code> and <code>NativeExecutor</code>.
The main purpose of <code>NativeContext</code> is MLIR initialization, compilation and lowering to LLVM.
<code>NativeExecutor</code> in the other hand is responsible of executing MLIR compiled sierra programs
from an entrypoint.
Programs and JIT states can be cached in contexts where their execution will be done multiple
times.</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>starknet_types_core::felt::Felt;
<span class="kw">use </span>cairo_native::context::NativeContext;
<span class="kw">use </span>cairo_native::executor::JitNativeExecutor;
<span class="kw">use </span>cairo_native::values::JitValue;
<span class="kw">use </span>std::path::Path;

<span class="kw">let </span>program_path = Path::new(<span class="string">&quot;programs/examples/hello.cairo&quot;</span>);
<span class="comment">// Compile the cairo program to sierra.
</span><span class="kw">let </span>sierra_program = cairo_native::utils::cairo_to_sierra(program_path);

<span class="comment">// Instantiate a Cairo Native MLIR context. This data structure is responsible for the MLIR
// initialization and compilation of sierra programs into a MLIR module.
</span><span class="kw">let </span>native_context = NativeContext::new();

<span class="comment">// Compile the sierra program into a MLIR module.
</span><span class="kw">let </span>native_program = native_context.compile(<span class="kw-2">&amp;</span>sierra_program).unwrap();

<span class="comment">// The parameters of the entry point.
</span><span class="kw">let </span>params = <span class="kw-2">&amp;</span>[JitValue::Felt252(Felt::from_bytes_be_slice(<span class="string">b&quot;user&quot;</span>))];

<span class="comment">// Find the entry point id by its name.
</span><span class="kw">let </span>entry_point = <span class="string">&quot;hello::hello::greet&quot;</span>;
<span class="kw">let </span>entry_point_id = cairo_native::utils::find_function_id(<span class="kw-2">&amp;</span>sierra_program, entry_point);

<span class="comment">// Instantiate the executor.
</span><span class="kw">let </span>native_executor = JitNativeExecutor::from_native_module(native_program, Default::default());

<span class="comment">// Execute the program.
</span><span class="kw">let </span>result = native_executor
    .invoke_dynamic(entry_point_id, params, <span class="prelude-val">None</span>, <span class="prelude-val">None</span>)
    .unwrap();

<span class="macro">println!</span>(<span class="string">&quot;Cairo program was compiled and executed successfully.&quot;</span>);
<span class="macro">println!</span>(<span class="string">&quot;{:?}&quot;</span>, result);

</code></pre></div>
<h3 id="common-definitions"><a href="#common-definitions">Common definitions</a></h3>
<p>Within this project there are lots of functions with the same signature. As their arguments have
all the same meaning, they are documented here:</p>
<ul>
<li><code>context: NativeContext</code>: The MLIR context.</li>
<li><code>module: &amp;NativeModule</code>: The compiled MLIR program, with other relevant information such as program registry and metadata.</li>
<li><code>program: &amp;Program</code>: The Sierra input program.</li>
<li><code>registry: &amp;ProgramRegistry&lt;TType, TLibfunc&gt;</code>: The registry extracted from the program.</li>
<li><code>metadata: &amp;mut MetadataStorage</code>: Current compiler metadata.</li>
</ul>
</div></details><h2 id="modules" class="small-section-header"><a href="#modules">Modules</a></h2><ul class="item-table"><li><div class="item-name"><a class="mod" href="cache/index.html" title="mod cairo_native::cache">cache</a></div></li><li><div class="item-name"><a class="mod" href="context/index.html" title="mod cairo_native::context">context</a></div></li><li><div class="item-name"><a class="mod" href="debug_info/index.html" title="mod cairo_native::debug_info">debug_info</a></div><div class="desc docblock-short">Extracts useful debugging information from cairo programs to make it available to the generated MLIR.</div></li><li><div class="item-name"><a class="mod" href="error/index.html" title="mod cairo_native::error">error</a></div><div class="desc docblock-short">Various error types used thorough the crate.</div></li><li><div class="item-name"><a class="mod" href="execution_result/index.html" title="mod cairo_native::execution_result">execution_result</a></div></li><li><div class="item-name"><a class="mod" href="executor/index.html" title="mod cairo_native::executor">executor</a></div></li><li><div class="item-name"><a class="mod" href="libfuncs/index.html" title="mod cairo_native::libfuncs">libfuncs</a></div><div class="desc docblock-short">Compiler libfunc infrastructure</div></li><li><div class="item-name"><a class="mod" href="metadata/index.html" title="mod cairo_native::metadata">metadata</a></div><div class="desc docblock-short">Code generation metadata</div></li><li><div class="item-name"><a class="mod" href="module/index.html" title="mod cairo_native::module">module</a></div></li><li><div class="item-name"><a class="mod" href="starknet/index.html" title="mod cairo_native::starknet">starknet</a></div><div class="desc docblock-short">Starknet related code for <code>cairo_native</code></div></li><li><div class="item-name"><a class="mod" href="types/index.html" title="mod cairo_native::types">types</a></div><div class="desc docblock-short">Compiler type infrastructure</div></li><li><div class="item-name"><a class="mod" href="utils/index.html" title="mod cairo_native::utils">utils</a></div><div class="desc docblock-short">Various utilities</div></li><li><div class="item-name"><a class="mod" href="values/index.html" title="mod cairo_native::values">values</a></div><div class="desc docblock-short">JIT params and return values de/serialization</div></li></ul><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.LLVMCompileError.html" title="struct cairo_native::LLVMCompileError">LLVMCompileError</a></div></li></ul><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2><ul class="item-table"><li><div class="item-name"><a class="enum" href="enum.OptLevel.html" title="enum cairo_native::OptLevel">OptLevel</a></div></li></ul><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2><ul class="item-table"><li><div class="item-name"><a class="fn" href="fn.compile.html" title="fn cairo_native::compile">compile</a></div><div class="desc docblock-short">Run the compiler on a program. The compiled program is stored in the MLIR module.</div></li><li><div class="item-name"><a class="fn" href="fn.module_to_object.html" title="fn cairo_native::module_to_object">module_to_object</a></div><div class="desc docblock-short">Make sure to call</div></li><li><div class="item-name"><a class="fn" href="fn.object_to_shared_lib.html" title="fn cairo_native::object_to_shared_lib">object_to_shared_lib</a></div></li></ul></section></div></main></body></html>